<!DOCTYPE html>
<html>
    <script src="https://d3js.org/d3.v7.min.js"></script>
<head>
    <title>Gráfico de Barras Apiladas con D3.js</title>
    <style>
        svg {
            font-family: Arial, sans-serif;
        }
        .bar {
            fill-opacity: 0.8;
        }
        .bar text {
            fill: white;
            font-size: 12px;
            text-anchor: middle;
        }
    </style>
</head>
<body>
    <svg id="chart"></svg>

    <script>
        var data = [
            {category: 'Estatica de Tamano Fijo', values: [1048576, 1048576, 1048576, 1048576, 1048576, 1048576]},
        ];

        var margin = {top: 20, right: 30, bottom: 30, left: 80};
        var width = 400 - margin.left - margin.right;
        var height = 300 - margin.top - margin.bottom;

        var svg = d3.select('#chart')
                    .attr('width', width + margin.left + margin.right)
                    .attr('height', height + margin.top + margin.bottom)
                    .append('g')
                    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

        var x = d3.scaleBand()
                  .domain(data.map(function(d) { return d.category; }))
                  .range([0, width])
                  .padding(0.1);

        var yValues = [0, 1048576, 2097152, 3145728,16777215, 15728640, 14680064, 13631488, 12582912, 11534336, 10485760, 9437184, 8388608, 7340032, 6291456, 5242880, 4194304]; // Valores personalizados para el eje y
        var y = d3.scaleLinear()
            .domain([0, d3.max(yValues)]) // Ajustar el dominio para adaptarse a los valores personalizados
            .range([height, 0]);

        svg.append('g')
           .attr('transform', 'translate(0,' + height + ')')
           .call(d3.axisBottom(x));

        svg.append('g')
            .call(d3.axisLeft(y).tickValues(yValues));

        var stackedData = d3.stack()
                            .keys(d3.range(data[0].values.length))
                            (data.map(function(d) { return d.values; }));

        svg.append('g')
           .selectAll('g')
           .data(stackedData)
           .enter().append('g')
           .attr('fill', function(d, i) { return d3.schemeCategory10[i]; }) // Asignar color basado en el índice
           .selectAll('rect')
           .data(function(d) { return d; })
           .enter().append('rect')
           .attr('x', function(d, i) { return x(data[i].category); })
           .attr('y', function(d) { return y(d[1]); })
           .attr('height', function(d) { return y(d[0]) - y(d[1]); })
           .attr('width', x.bandwidth());

        svg.selectAll('.bar')
           .data(data)
           .enter().append('g')
           .attr('class', 'bar')
           .selectAll('text')
           .data(function(d) { return d.values; })
           .enter().append('text')
           .attr('x', function(d, i) { return x(d) + x.bandwidth() / 2; })
           .attr('y', function(d) { return y(d) - 5; })
           .attr('dy', '.75em')
           .attr('fill', 'black')
           .text(function(d) { return d; });
    </script>
</body>

</html>

